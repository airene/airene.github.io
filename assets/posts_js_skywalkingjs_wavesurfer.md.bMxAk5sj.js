import{_ as e,o as s,c as a,R as r}from"./chunks/framework.DO9dm5bS.js";const _=JSON.parse('{"title":"从skywalkingjs和wavesurfer.js同时使用后者无法工作到给官方提交一个PR","description":"一个项目用到了wavesurfer.js，项目又在之前引用了skywalking做链路追踪，结果就是二进制流的wave图形加载不出来，控制台没有任何报错","frontmatter":{"date":"2022-11-15T00:00:00.000Z","title":"从skywalkingjs和wavesurfer.js同时使用后者无法工作到给官方提交一个PR","tags":["js"],"description":"一个项目用到了wavesurfer.js，项目又在之前引用了skywalking做链路追踪，结果就是二进制流的wave图形加载不出来，控制台没有任何报错"},"headers":[],"relativePath":"posts/js_skywalkingjs_wavesurfer.md","filePath":"posts/js_skywalkingjs_wavesurfer.md"}'),t={name:"posts/js_skywalkingjs_wavesurfer.md"},l=r('<h1 id="从skywalkingjs和wavesurfer-js同时使用后者无法工作到给官方提交一个pr" tabindex="-1">从skywalkingjs和wavesurfer.js同时使用后者无法工作到给官方提交一个PR <a class="header-anchor" href="#从skywalkingjs和wavesurfer-js同时使用后者无法工作到给官方提交一个pr" aria-label="Permalink to &quot;从skywalkingjs和wavesurfer.js同时使用后者无法工作到给官方提交一个PR&quot;">​</a></h1><h2 id="坑" tabindex="-1">坑 <a class="header-anchor" href="#坑" aria-label="Permalink to &quot;坑&quot;">​</a></h2><ul><li>skywalkingjs把一个正常的请求拦截了，和没请求一样，控制台一毛钱的错误或者警告输出都没有</li><li>因为声音文件不是静态文件，一开始怀疑wavesurfer.js对流的支持不好，各种换版本和流参数尝试，没想到是像其他模块或者js影响了它，在这个上花费了大量的时间</li><li>vite框架调试非项目代码，而是第三方依赖还是有点费劲，目前没找到合适的方法,当前解决办法： <ul><li>修改node_modules/.vite文件夹下的编译完的文件（也就是浏览器加载的文件）</li><li>修改这个内容必须重启vite才能生效</li></ul></li><li>调试到最后发现wavesurfer.js是用fetch作为资源加载的方式方法</li><li>再往后是发现是用的fatch但是又不是<strong>常见</strong>用法。。。</li></ul><p>大部分时候是使用axios类库做资源请求，fetch本身用的比较少，用fetch也是第一个参数是一个url string</p><p>wavesurfer.js用的fetch的第一个参数是一个 Request 对象的方式，这个对象是一个实验性的，虽然诸多浏览器从很早就开始支持了。</p><p>skywalking的js sdk不支持这种方式，所以请求吞了，实际是报错了，抛不出来。。</p><p>做一个兼容处理就好了<br><a href="https://github.com/apache/skywalking-client-js/commit/f12941ba2d91d8d38632589424f9b3a9418349dc" target="_blank" rel="noreferrer">https://github.com/apache/skywalking-client-js/commit/f12941ba2d91d8d38632589424f9b3a9418349dc</a></p><h2 id="参考" tabindex="-1">参考 <a class="header-anchor" href="#参考" aria-label="Permalink to &quot;参考&quot;">​</a></h2><ul><li><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/fetch" target="_blank" rel="noreferrer">https://developer.mozilla.org/zh-CN/docs/Web/API/fetch</a></li><li><a href="https://github.com/katspaugh/wavesurfer.js/blob/master/src/util/fetch.js" target="_blank" rel="noreferrer">https://github.com/katspaugh/wavesurfer.js/blob/master/src/util/fetch.js</a></li><li>wavesurfer version is 6.4.0的fetch.js line 122,148</li></ul>',9),i=[l];function o(n,c,h,f,u,k){return s(),a("div",null,i)}const p=e(t,[["render",o]]);export{_ as __pageData,p as default};
