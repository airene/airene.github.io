import{_ as s,o as a,c as t,a as p,f as o,r as e}from"./app.af42795b.js";const h='{"title":"PSD\u6587\u4EF6\u51CF\u5C0F\u4F53\u79EF","description":"\u6709\u65F6\u5019\u4E00\u4E2Apsd\u6587\u4EF6\u6709\u7528\u7684\u4FE1\u606F\u57FA\u672C\u4E0A\u6CA1\u6709\uFF0C\u4F46\u662F\u6587\u4EF6\u4F53\u79EF\u90FD\u5230\u5927\u51E0\u5341M\uFF0C\u641C\u4E86\u5F88\u591A\u65B9\u6CD5\u624D\u627E\u5230\u8FD9\u4E2A\u795E\u5947\u7684\u51FD\u6570","frontmatter":{"date":"2017-03-31T00:00:00.000Z","title":"PSD\u6587\u4EF6\u51CF\u5C0F\u4F53\u79EF","tags":["photoshop"],"description":"\u6709\u65F6\u5019\u4E00\u4E2Apsd\u6587\u4EF6\u6709\u7528\u7684\u4FE1\u606F\u57FA\u672C\u4E0A\u6CA1\u6709\uFF0C\u4F46\u662F\u6587\u4EF6\u4F53\u79EF\u90FD\u5230\u5927\u51E0\u5341M\uFF0C\u641C\u4E86\u5F88\u591A\u65B9\u6CD5\u624D\u627E\u5230\u8FD9\u4E2A\u795E\u5947\u7684\u51FD\u6570"},"headers":[],"relativePath":"posts/psd_size_reduce.md"}',c={},u=o(`<h1 id="psd\u6587\u4EF6\u51CF\u5C0F\u4F53\u79EF" tabindex="-1">PSD\u6587\u4EF6\u51CF\u5C0F\u4F53\u79EF <a class="header-anchor" href="#psd\u6587\u4EF6\u51CF\u5C0F\u4F53\u79EF" aria-hidden="true">#</a></h1><p>\u6709\u65F6\u5019\u4E00\u4E2Apsd\u6587\u4EF6\u6709\u7528\u7684\u4FE1\u606F\u57FA\u672C\u4E0A\u6CA1\u6709\uFF0C\u4F46\u662F\u6587\u4EF6\u4F53\u79EF\u90FD\u5230\u5927\u51E0\u5341M\uFF0C\u641C\u4E86\u5F88\u591A\u65B9\u6CD5\u624D\u627E\u5230\u8FD9\u4E2A\u795E\u5947\u7684\u51FD\u6570</p><div class="language-jsx"><pre><code><span class="token keyword">function</span> <span class="token function">deleteDocumentAncestorsMetadata</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    whatApp <span class="token operator">=</span> <span class="token function">String</span><span class="token punctuation">(</span>app<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//String version of the app name</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>whatApp<span class="token punctuation">.</span><span class="token function">search</span><span class="token punctuation">(</span><span class="token string">&quot;Photoshop&quot;</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span>  <span class="token punctuation">{</span> <span class="token comment">//Check for photoshop specifically, or this will cause errors</span>
        <span class="token comment">//Function Scrubs Document Ancestors from Files</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>documents<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">&quot;There are no open documents. Please open a file to run this script.&quot;</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>ExternalObject<span class="token punctuation">.</span>AdobeXMPScript <span class="token operator">==</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span> ExternalObject<span class="token punctuation">.</span>AdobeXMPScript <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ExternalObject</span><span class="token punctuation">(</span><span class="token string">&quot;lib:AdobeXMPScript&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> xmp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMPMeta</span><span class="token punctuation">(</span> activeDocument<span class="token punctuation">.</span>xmpMetadata<span class="token punctuation">.</span>rawData<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// Begone foul Document Ancestors!</span>
            xmp<span class="token punctuation">.</span><span class="token function">deleteProperty</span><span class="token punctuation">(</span>XMPConst<span class="token punctuation">.</span><span class="token constant">NS_PHOTOSHOP</span><span class="token punctuation">,</span> <span class="token string">&quot;DocumentAncestors&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            app<span class="token punctuation">.</span>activeDocument<span class="token punctuation">.</span>xmpMetadata<span class="token punctuation">.</span>rawData <span class="token operator">=</span> xmp<span class="token punctuation">.</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">//Now run the function to remove the document ancestors</span>
<span class="token function">deleteDocumentAncestorsMetadata</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>`,3);function l(i,k,r,d,m,_){const n=e("Comment");return a(),t("div",null,[u,p(n)])}var w=s(c,[["render",l]]);export{h as __pageData,w as default};
