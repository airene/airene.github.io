import{r as n,o as s,c as a,a as t,f as p}from"./app.86edd808.js";const o='{"title":"PSD文件减小体积","description":"有时候一个psd文件有用的信息基本上没有，但是文件体积都到大几十M，搜了很多方法才找到这个神奇的函数","frontmatter":{"date":"2017-03-31","title":"PSD文件减小体积","tags":["photoshop"],"description":"有时候一个psd文件有用的信息基本上没有，但是文件体积都到大几十M，搜了很多方法才找到这个神奇的函数"},"relativePath":"posts/psd_size_reduce.md","lastUpdated":1629367731057}',e={},c=p('<h1 id="psd文件减小体积"><a class="header-anchor" href="#psd文件减小体积" aria-hidden="true">#</a> PSD文件减小体积</h1><p>有时候一个psd文件有用的信息基本上没有，但是文件体积都到大几十M，搜了很多方法才找到这个神奇的函数</p><div class="language-jsx"><pre><code><span class="token keyword">function</span> <span class="token function">deleteDocumentAncestorsMetadata</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    whatApp <span class="token operator">=</span> <span class="token function">String</span><span class="token punctuation">(</span>app<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//String version of the app name</span>\n    <span class="token keyword">if</span><span class="token punctuation">(</span>whatApp<span class="token punctuation">.</span><span class="token function">search</span><span class="token punctuation">(</span><span class="token string">&quot;Photoshop&quot;</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span>  <span class="token punctuation">{</span> <span class="token comment">//Check for photoshop specifically, or this will cause errors</span>\n        <span class="token comment">//Function Scrubs Document Ancestors from Files</span>\n        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>documents<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">&quot;There are no open documents. Please open a file to run this script.&quot;</span><span class="token punctuation">)</span>\n        <span class="token keyword">return</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span>\n        <span class="token keyword">if</span> <span class="token punctuation">(</span>ExternalObject<span class="token punctuation">.</span>AdobeXMPScript <span class="token operator">==</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span> ExternalObject<span class="token punctuation">.</span>AdobeXMPScript <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ExternalObject</span><span class="token punctuation">(</span><span class="token string">&quot;lib:AdobeXMPScript&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token keyword">var</span> xmp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMPMeta</span><span class="token punctuation">(</span> activeDocument<span class="token punctuation">.</span>xmpMetadata<span class="token punctuation">.</span>rawData<span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token comment">// Begone foul Document Ancestors!</span>\n            xmp<span class="token punctuation">.</span><span class="token function">deleteProperty</span><span class="token punctuation">(</span>XMPConst<span class="token punctuation">.</span><span class="token constant">NS_PHOTOSHOP</span><span class="token punctuation">,</span> <span class="token string">&quot;DocumentAncestors&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n            app<span class="token punctuation">.</span>activeDocument<span class="token punctuation">.</span>xmpMetadata<span class="token punctuation">.</span>rawData <span class="token operator">=</span> xmp<span class="token punctuation">.</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n         <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n<span class="token comment">//Now run the function to remove the document ancestors</span>\n<span class="token function">deleteDocumentAncestorsMetadata</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre></div>',3);e.render=function(p,o,e,u,l,i){const k=n("Comment");return s(),a("div",null,[c,t(k)])};export{o as __pageData,e as default};
